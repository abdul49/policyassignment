[
    //Deny Public Access Policy for Azure Data Factory (IT & PL Only)
        { 
            "displayName": "RWE - Azure Data Factory public network access is denied - IT",
             "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1cf164be-6819-4a50-b8fa-4bcaa4f98fb6",
            "parameters": {
                "effect": "Deny"
            },
             "useIdentity": false    
        }, 
            { 
            "displayName": "RWE - Azure Data Factory public network access is denied - PL",
             "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1cf164be-6819-4a50-b8fa-4bcaa4f98fb6",
            "parameters": {
                "effect": "Deny"
            },
             "useIdentity": false    
        }, 
    // End of - Deny Public Access Policy for Azure Data Factory (IT & PL Only)
    //Deny Public Access Policy for Azure Event Grid Topics (IT & PL Only)
        { 
            "displayName": "RWE - Azure Event Grid topics public network access is denied - IT",
             "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1adadefe-5f21-44f7-b931-a59b54ccdb45",
            "parameters": {
                "effect": "Deny"
            },
             "useIdentity": false    
        }, 
            { 
            "displayName": "RWE - Azure Event Grid topics public network access is denied - PL",
             "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1adadefe-5f21-44f7-b931-a59b54ccdb45",
            "parameters": {
                "effect": "Deny"
            },
             "useIdentity": false    
        }, 
    // End of - Deny Public Access Policy for Azure Event Grid Topics(IT & PL Only)
    //Deny Public Access Policy for Azure Event Grid Domains (IT & PL Only)
        { 
            "displayName": "RWE - Azure Event Grid domains public network access is denied - IT",
             "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f8f774be-6aee-492a-9e29-486ef81f3a68",
            "parameters": {
                "effect": "Deny"
            },
             "useIdentity": false    
        }, 
            { 
            "displayName": "RWE - Azure Event Grid domains public network access is denied - PL",
             "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f8f774be-6aee-492a-9e29-486ef81f3a68",
            "parameters": {
                "effect": "Deny"
            },
             "useIdentity": false    
        }, 
    // End of - Deny Public Access Policy for Azure Event Grid Domains (IT & PL Only)
        {
            "displayName": "RWE - Application Gateway TLS Enforcement",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Modify-AppGW-TLS+Ciphers",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Modify",
                "tls_version": "TLSv1_2",
                "ciphers": [
                    "TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256",
                    "TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384",
                    "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA",
                    "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA",
                    "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256",
                    "TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384",
                    "TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384",
                    "TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256",
                    "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA",
                    "TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA",
                    "TLS_RSA_WITH_AES_256_GCM_SHA384",
                    "TLS_RSA_WITH_AES_128_GCM_SHA256",
                    "TLS_RSA_WITH_AES_256_CBC_SHA256",
                    "TLS_RSA_WITH_AES_128_CBC_SHA256",
                    "TLS_RSA_WITH_AES_256_CBC_SHA",
                    "TLS_RSA_WITH_AES_128_CBC_SHA"
                  ]
            },
             "useIdentity": true
        },
        { 
            "displayName": "RWE - Audit Application Gateways for Enabled Web Application Firewall",
             "managementGroupIdSuffix": "",
            "policyDefinition": "Audit-WAF-Enabled-AppGW",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {},
             "useIdentity": false    
        }, 
        { 
            "displayName": "RWE - Audit Application Gateways for Mode Prevention Web Application Firewall",
             "managementGroupIdSuffix": "",
            "policyDefinition": "Audit-WAF-Prevention-AppGW",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
             "useIdentity": false    
        }, 
        { 
            "displayName": "RWE - Audit Application Gateways for WAF_v2 Web Application Firewall",
             "managementGroupIdSuffix": "",
            "policyDefinition": "Audit-WAF-SKU-tier-AppGW",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
             "useIdentity": false    
        }, 
        { 
           "displayName": "RWE - Subnets for NSG rules on SSH/RDP-Bastion - Deny",
            "managementGroupIdSuffix": "",
           "policyDefinition": "Audit-NSG-RDP-SSH-Source-v3",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "deny",
                "allowedSourceIpAddress": "10.47.3.0/26"
            },

            "useIdentity": false    
        },
        { 
           "displayName": "RWE - Audit Subnets for NSG rules with Any destination ports",
            "managementGroupIdSuffix": "",
           "policyDefinition": "Audit-NSG-Any-Destination",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false    
        },
        {
            "displayName": "RWE - Images For Scale Set Builds Should be in the Approved List v2 - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Audit-AllowedImages-Scalesets",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        }, 
        {
            "displayName": "RWE - Images For Builds Should be in the Approved List v2 - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Audit-AllowedImages",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Restrict use of Migration Tag for Image Restriction - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deny-migrating-tagging",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
        "displayName": "RWE - Public network access on Azure Kubernetes Services should be disabled",
        "managementGroupIdSuffix": "",
        "policyDefinition": "Deny-PublicEndpoint-Aks",
        "notScopes": [
            "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
            "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
            "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
        ],        
        "parameters": {
            "effect": "Deny"
        },
        "useIdentity": false
        },
        //start-Audit Subnet without UDR custom- Policy Assignments [ -IT | -PL | -COR ]
        {
            "displayName": "RWE - Audit subnets without User Defined Routes - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "rwe-audit-subnet-without-udr",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Audit subnets without User Defined Routes  PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "rwe-audit-subnet-without-udr",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Audit subnets without User Defined Routes - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "rwe-audit-subnet-without-udr",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //End-Subnet without UDR - Policy Assignments [ -IT | -PL | -COR ]
        {
            "displayName": "RWE - Public network access should be disabled for Key Vaults",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deny-PublicEndpoint-KeyVault",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Public network access should be disabled for Storage Accounts",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Cache for Redis should disable public network access",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/470baccb-7e51-4549-8b1a-3e5be069f663",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },   
        // Start - Redis Cache Guardrails - Secure Connection Only (Deny)
        {
            "displayName": "RWE - Redis Non-SSL port not allowed - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        // End - Redis Cache Guardrails - Secure Connection Only (Deny)
        {
            "displayName": "RWE - Public network access on Azure SQL Database should be disabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deny-PublicEndpoint-Sql",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Public network access should be disabled for MySQL servers",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deny-PublicEndpoint-MySQL",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Public network access should be disabled for PostgreSQL servers",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Modify-PublicEndpoint-PostgreSQL",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {
                "effect": "Modify"
            },
            "useIdentity": true
        },
        { 
            "displayName": "RWE - Public network access should be disabled for PostgreSQL flexible servers",
             "managementGroupIdSuffix": "",
            "policyDefinition": "Deny-PostgreSQL-flexibleserver-public",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
             "useIdentity": false    
        }, 
        { 
            "displayName": "RWE - Public network access should be disabled for MySQL flexible servers",
             "managementGroupIdSuffix": "",
            "policyDefinition": "Deny-MySQL-flexibleserver-public",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
             "useIdentity": false    
        }, 
    // Start - Default Azure Security Benchmark applied at top level MGs
        { 
            "displayName": "RWE - Azure Security Benchmark - Default",
            "managementGroupIdSuffix": "",
            "policySetDefinition": "/providers/Microsoft.Authorization/policySetDefinitions/1f3afdf9-d0c9-4c3d-847f-89da613e70a8",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {},
            "useIdentity": false
        },
    // End - Default Azure Security Benchmark applied at top level MG
        { 
            "displayName": "RWE - CIS Microsoft Azure Foundations Benchmark v1.3.0 - Default",
            "managementGroupIdSuffix": "",
            "policySetDefinition": "/providers/Microsoft.Authorization/policySetDefinitions/612b5213-9160-4969-8578-1518bd2a000c",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE-Deploy-FTPS Only Mode for App Services",
            "managementGroupIdSuffix": "",
            "policyDefinition": "DINE-FTPSOnlyAppService",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "RWE - App Service apps should use a SKU that supports private link - Audit",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/546fe8d2-368d-4029-a418-6af48a7f61e5",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service apps should disable public network access",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1b5ef780-c53c-4a64-87f3-bb9c8c8094ba",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //Added the block to deploy private DNS records automatically 
        {
            "displayName": "RWE - Automatic DNS Creation for Private Endpoints",
            "managementGroupIdSuffix": "",
            "policySetDefinition": "RWE - Automatic DNS Creation for Private Endpoints",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {			
				"privateDnsZoneId": "/subscriptions/%SUBID%/resourceGroups/zc03x-lzp-dns-euw1-rg-%ENV%/providers/Microsoft.Network/privateDnsZones/"
            },
            "useIdentity": true
        },
        { 
            "displayName": "RWE - CIS Microsoft Azure Foundations Benchmark v1.3.0",
            "managementGroupIdSuffix": "",
            "policySetDefinition": "RWE-CIS-Benchmark-v130",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Key Vault keys should have an expiration date",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Key Vault secrets should have an expiration date",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Key vaults should have purge protection enabled - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure SQL Database should have Azure Active Directory Only Authentication enabled - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure SQL Database should have Azure Active Directory Only Authentication enabled - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure SQL Database should have Azure Active Directory Only Authentication enabled - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure SQL Managed Instance should have Azure Active Directory Only Authentication enabled - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure SQL Managed Instance should have Azure Active Directory Only Authentication enabled - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure SQL Managed Instance should have Azure Active Directory Only Authentication enabled - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //start-Deploy-App Services policies in -IT-C03X-NP
        {
            "displayName": "RWE - App Service Apps should be injected into a virtual network-Deny",
            "managementGroupIdSuffix": "-IT-C03X-NP",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/72d04c29-f87d-4575-9731-419ff16a2757",
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },   
        {
            "displayName": "RWE - App Service apps should use a SKU that supports private link-Deny",
            "managementGroupIdSuffix": "-IT-C03X-NP",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/546fe8d2-368d-4029-a418-6af48a7f61e5",
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        //end-Deploy-App Services policies in -IT-C03X-NP	
        // start - Authentication should be enabled on your Web, Function, API apps in RWE-ALZ
        {
            "displayName": "RWE - Authentication should be enabled on your Function app",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/c75248c1-ea1d-4a9c-8fc9-29a6aabd5da8",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Authentication should be enabled on your App Service Apps",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/95bccee9-a7f8-4bec-9ee9-62c3473701fc",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },	
        //End - Authentication should be enabled on your Web, Function, API apps in RWE-ALZ
        {
            "displayName": "RWE - App Service apps should disable public network access - Audit",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1b5ef780-c53c-4a64-87f3-bb9c8c8094ba",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ], 
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Apps should be injected into a virtual network - Audit",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/72d04c29-f87d-4575-9731-419ff16a2757",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ], 
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //Storage Account set to minimum TLS and Secure transfer should be enabled
        {
            "displayName": "RWE - Storage Account set to minimum TLS and Secure transfer should be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-tls12-Azure-Storage-Accounts",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        //Deploy-policy-Configure App Services to disable public network access in -IT-C03X-NP
        {
            "displayName": "RWE - Configure App Services to disable public network access - IT-C03X-NP",
            "managementGroupIdSuffix": "-IT-C03X-NP",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/81dff7c0-4020-4b58-955d-c076a2136b56",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        //Deploy-App Service apps should enable outbound non-RFC 1918 traffic to Azure Virtual Network in -IT-C03X-NP
        {
            "displayName": "RWE - App Service apps should enable outbound non-RFC 1918 traffic to Azure Virtual Network - IT-C03X-NP",
            "managementGroupIdSuffix": "-IT-C03X-NP",
            "policyDefinition": "rwe-enable-AppServices-apps-outbound-non-RFC-1918",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        //Azure Storage deploy a specific min TLS version requirement and enforce SSL HTTPS
        {
            "displayName": "RWE - Azure Storage deploy a specific min TLS version requirement and enforce SSL HTTPS",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-enforce-ssl-tls12-Azure-Storage-Accounts",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "RWE- Deploy SQL DB transparent data encryption",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/86a912f6-9a06-4e26-b447-11b16ba8659f",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {},
            "useIdentity": true
        },
        {
            "displayName": "RWE- Kubernetes clusters should be accessible only over HTTPS",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE- Kubernetes cluster pod security restricted standards for Linux-based workloads",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policySetDefinitions/a8640138-9b0a-4a28-b8cb-1666c838647d",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE- Role-Based Access Control (RBAC) should be used on Kubernetes Services",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE- Kubernetes clusters should use internal load balancers",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/3fc4dc25-5baf-40d8-9b05-7fe74c1bc64e",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE- Azure Kubernetes Service Private Clusters should be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/040732e8-d947-40b8-95d6-854c95024bf8",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "Both operating systems and data disks in Azure Kubernetes Service clusters should be encrypted using customer-managed keys",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/7d7be79c-23ba-4033-84dd-45e2a5ccdd67",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Deploy Azure Policy Add-on to Azure Kubernetes Service clusters",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/a8eff44f-8c92-45c3-a3fb-9880802d67a7",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": true
        },
        {
            "displayName": "RWE - Configure diagnostic settings for Azure Kubernetes Service to Log Analytics workspace",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deploy-Diagnostics-AKS",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "logAnalytics": "/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourcegroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/microsoft.operationalinsights/workspaces/zc03x-lzp-log-euw1-log001-pr01"
            },
            "useIdentity": true
        },
        //Start - Redis Cache Guardrails - Min TLS 1.2 (Append)
        {
            "displayName": "RWE - Redis minimum TLS version 1.2 enforcement - Append",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Append-Redis-sslEnforcement",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        // End - Redis Cache Guardrails - Min TLS 1.2 (Append)
        // Start - Redis Cache Guardrails - Disable Non SSL ports (Append)
        {
            "displayName": "RWE - Redis Non-SSL port not allowed - Append",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Append-Redis-disableNonSslPort",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        // End - Redis Cache Guardrails - Disable Non SSL ports (Append)
        // Start - Redis Cache Guardrails - Min TLS 1.2 (Deny)
        {
            "displayName": "RWE - Redis minimum TLS version 1.2 enforcement - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deny-Redis-Http-Connections",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        // End - Redis Cache Guardrails - Min TLS 1.2 (Deny)
        {
            "displayName": "RWE - Enforce TLS 1.2 for App Service",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Append-AppService-TLS1,2",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Enforce HTTPS only mode for App Service",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Append-AppService-HTTPSonly",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],        
            "parameters": {},
            "useIdentity": false
        },
        //{
        //    "displayName": "RWE - Deploy Azure Defender settings in Azure Security Center",
        //    "managementGroupIdSuffix": "",
        //    "policyDefinition": "Deploy-ASC-Standard",
        //    "parameters": {},
        //    "useIdentity": true
        //},
        //{
        //    "displayName": "RWE - Resource logs in Azure Key Vault Managed HSM should be enabled",
        //    "managementGroupIdSuffix": "",
        //    "policyDefinition": "AuditINE-KV-MHSMResourceLogsEnabled",
        //    "parameters": {},
        //    "useIdentity": false
        //},
        {
            "displayName": "RWE - Azure Security Centre High Severity Alerts - Email Contact deployment",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deploy-ASC-SecurityContacts",
            "parameters": {
                "emailSecurityContact": "azure_security_alerts@rwe.com"
            },
            "useIdentity": true
        },
        {
            "displayName": "RWE - Deny peerings on Sandpit environment - SP",
            "managementGroupIdSuffix": "-SP",
            "policyDefinition": "Deny-sp-peerings",
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Key vaults should have soft delete enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Audit-KV-SoftDelete",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Disabled"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Key Vault Managed HSM should have purge protection enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Audit-KV-MHSM-Purge-Protection",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Audit Windows machines that do not have a minimum password age of 1 day",
            "managementGroupIdSuffix": "",
            "policyDefinition": "VM-Password-Min-1day",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Audit Windows machines that do not have a maximum password age of 70 days",
            "managementGroupIdSuffix": "",
            "policyDefinition": "VM-Password-Max-70days",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Deny PublicEndpoint MySQL",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "Deny-PublicEndpoint-MySQL",
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Deny other peerings that are not the hub",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "Deny-other-peerings",
            "parameters": {
                "allowedVnetId___ID": "z%ORG%x-%PLATFORM%-net-%REGION%-vnet001-%ENV%"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Deny other peerings that are not the hub",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "Deny-other-peerings",
            "parameters": {
                "allowedVnetId___ID": "z%ORG%x-%PLATFORM%-net-%REGION%-vnet001-%ENV%"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Allowed locations - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "parameters": {
                "listOfAllowedLocations": [
                    "westeurope"
                ]
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Allowed locations - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "parameters": {
                "listOfAllowedLocations": [
                    "westeurope",
                    "northeurope"
                ]
            }
        },
        {
            "displayName": "RWE - Allowed locations - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e56962a6-4747-49cd-b67b-bf8b01975c4c",
            "parameters": {
                "listOfAllowedLocations": [
                    "westeurope",
                    "northeurope"
                ]
            }
        },
        // {
        //     "displayName": "RWE - Deny other peerings that are not the hub",
        //     "managementGroupIdSuffix": "-NP",
        //     "policyDefinition": "Deny-other-peerings",
        //     "parameters": {
        //         "allowedVnetId___ID": "z%ORG%x-%PLATFORM%-net-%REGION%-vnet001-%ENV%"
        //     }
        // },
        {
            "displayName": "RWE - Audit Windows VM has NetworkWatcher Extension installed",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Audit-VM-NW-Windows",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Audit Linux VM has NetworkWatcher Extension installed",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Audit-VM-NW-Linux",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Enforce Tagging",
            "managementGroupIdSuffix": "",
            "policySetDefinition": "RWE-Tagging-policy",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],  
            "parameters": {},
            "useIdentity": false
        },
        //Commenting this assignment to resolve Jira-Ticket:IPMPCA-1058
        //{
        //    "displayName": "RWE - Inherit Tags From ResourceGroup",
        //    "managementGroupIdSuffix": "",
        //    "policySetDefinition": "RWE-Tagging-inheritance",
        //    "parameters": {},
        //    "useIdentity": true
        //},
        {
            "displayName": "RWE - Inherit Tags From Subscription",
            "managementGroupIdSuffix": "",
            "policySetDefinition": "RWE-Tagging-inheritance-subscription",
            "parameters": {},
            "useIdentity": true
        },    
        {
            "displayName": "RWE - Audit VM Naming standards",
            "managementGroupIdSuffix": "",
            "policySetDefinition": "RWE-VM-Naming-Standards",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": true
        },
       {
            "displayName": "RWE - Audit Windows virtual machines for central log analytics workspace configuraion",
            "managementGroupIdSuffix": "",
            "policyDefinition": "RWE-Audit-WindowsVMs-CLAWS-Configuraion",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-OT"
            ],
            "parameters": {
                "effect": "AuditIfNotExists",
                "logAnalyticsWorkspaceId":"4fe362c9-b365-40be-82c2-953dfbd6b70d",
                "listOfImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019_V2",
                    "/subscriptions/0c753207-134f-4389-a8a7-50137d64ae6e/resourceGroups/zc03x-citrixcloud-test-003/providers/Microsoft.Compute/galleries/VMDST0001_tfiyq/images/VMDST0001_t6c0u"
                ]
            },
            "useIdentity": true
        },
        {
            "displayName": "RWE - Audit Linux virtual machines for central log analytics workspace configuraion",
            "managementGroupIdSuffix": "",
            "policyDefinition": "RWE-Audit-LinuxVMs-CLAWS-Configuraion",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-OT"
            ],         
            "parameters": {
                "effect": "AuditIfNotExists",
                "logAnalyticsWorkspaceId":"4fe362c9-b365-40be-82c2-953dfbd6b70d",
                "listOfImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximglineuw1sig001pr01/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_pr/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-cib-linux-euw1-rg-pr/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_sp/images/testing_cif-rhel8_x86_64-gen2"
                ]
            },
            "useIdentity": true
        },
        
        // Start Container registries - Policy Assignments [ -IT | -PL | -COR ] 
        {
            "displayName": "RWE - Public network access should be disabled for Container registries - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Public network access should be disabled for Container registries - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Public network access should be disabled for Container registries - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0fdf0491-d080-4575-b627-ad0e843cba0f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should have exports disabled - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/524b0254-c285-4903-bee6-bb8126cde579",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should have exports disabled - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/524b0254-c285-4903-bee6-bb8126cde579",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should have exports disabled - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/524b0254-c285-4903-bee6-bb8126cde579",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should be encrypted with a customer-managed key - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should be encrypted with a customer-managed key - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should be encrypted with a customer-managed key - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should not allow unrestricted network access - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should not allow unrestricted network access - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should not allow unrestricted network access - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should have local authentication methods disabled - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/dc921057-6b28-4fbe-9b83-f7bec05db6c2",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should have local authentication methods disabled - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/dc921057-6b28-4fbe-9b83-f7bec05db6c2",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container registries should have local authentication methods disabled - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/dc921057-6b28-4fbe-9b83-f7bec05db6c2",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //End Container registries - Policy Assignments [ -IT | -PL | -COR ]  
        {
            "displayName": "RWE - Logic Apps should be deployed into Integration Service Environment",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/dc595cb1-1cde-45f6-8faf-f88874e1c0e1",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Logic Apps should be deployed into Integration Service Environment",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/dc595cb1-1cde-45f6-8faf-f88874e1c0e1",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Logic Apps should be deployed into Integration Service Environment",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/dc595cb1-1cde-45f6-8faf-f88874e1c0e1",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Logic Apps Integration Service Environment should be encrypted with customer-managed keys - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Logic Apps Integration Service Environment should be encrypted with customer-managed keys - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Logic Apps Integration Service Environment should be encrypted with customer-managed keys - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1fafeaf6-7927-4059-a50a-8eb2a7a6f2b5",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //Automation - Policy Assignments [ -IT | -PL | -COR | -SP ] 
        //{
        //    "displayName": "RWE - Private endpoint connections on Automation Accounts should be enabled - IT",
        //    "managementGroupIdSuffix": "-IT",
        //    "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0c2b3618-68a8-4034-a150-ff4abc873462",
        //    "parameters": {
        //        "effect": "AuditIfNotExists"
        //    },
        //    "useIdentity": false
        //},
        //{
        //    "displayName": "RWE - Private endpoint connections on Automation Accounts should be enabled - PL",
        //    "managementGroupIdSuffix": "-PL",
        //    "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0c2b3618-68a8-4034-a150-ff4abc873462",
        //    "parameters": {
        //        "effect": "AuditIfNotExists"
        //    },
        //    "useIdentity": false
        //},
        //{
        //    "displayName": "RWE - Private endpoint connections on Automation Accounts should be enabled - SP",
        //    "managementGroupIdSuffix": "-SP",
        //    "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0c2b3618-68a8-4034-a150-ff4abc873462",
        //    "parameters": {
        //        "effect": "AuditIfNotExists"
        //    },
        //    "useIdentity": false
        //},
        //{
        //    "displayName": "RWE - Private endpoint connections on Automation Accounts should be enabled - COR",
        //    "managementGroupIdSuffix": "-COR",
        //    "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0c2b3618-68a8-4034-a150-ff4abc873462",
        //    "parameters": {
        //        "effect": "AuditIfNotExists"
        //    },
        //    "useIdentity": false
        //},
        {
            "displayName": "RWE - Automation accounts should disable public network access - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/955a914f-bf86-4f0e-acd5-e0766b0efcb6",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Automation accounts should disable public network access - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/955a914f-bf86-4f0e-acd5-e0766b0efcb6",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Automation accounts should disable public network access - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/955a914f-bf86-4f0e-acd5-e0766b0efcb6",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Automation accounts should use customer-managed keys to encrypt data at rest - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/56a5ee18-2ae6-4810-86f7-18e39ce5629b",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Automation accounts should use customer-managed keys to encrypt data at rest - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/56a5ee18-2ae6-4810-86f7-18e39ce5629b",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Automation accounts should use customer-managed keys to encrypt data at rest - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/56a5ee18-2ae6-4810-86f7-18e39ce5629b",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //End Automation - Policy assignments
        // Start App Service - Policy Assignments [ -IT | -PL | -COR ] 
        {
            "displayName": "RWE - App Service Environment apps should not be reachable over public internet - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2d048aca-6479-4923-88f5-e2ac295d9af3",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment apps should not be reachable over public internet - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2d048aca-6479-4923-88f5-e2ac295d9af3",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment apps should not be reachable over public internet - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2d048aca-6479-4923-88f5-e2ac295d9af3",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should be configured with strongest TLS Cipher suites - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/817dcf37-e83d-4999-a472-644eada2ea1e",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should be configured with strongest TLS Cipher suites - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/817dcf37-e83d-4999-a472-644eada2ea1e",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should be configured with strongest TLS Cipher suites - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/817dcf37-e83d-4999-a472-644eada2ea1e",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should disable TLS 1.0 and 1.1 - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/d6545c6b-dd9d-4265-91e6-0b451e2f1c50",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should disable TLS 1.0 and 1.1 - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/d6545c6b-dd9d-4265-91e6-0b451e2f1c50",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should disable TLS 1.0 and 1.1 - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/d6545c6b-dd9d-4265-91e6-0b451e2f1c50",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should enable internal encryption - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/fb74e86f-d351-4b8d-b034-93da7391c01f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should enable internal encryption - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/fb74e86f-d351-4b8d-b034-93da7391c01f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should enable internal encryption - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/fb74e86f-d351-4b8d-b034-93da7391c01f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Services should disable public network access - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/63a0ac64-5d5f-4569-8a3d-df67cc1ce9d7",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Services should disable public network access - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/63a0ac64-5d5f-4569-8a3d-df67cc1ce9d7",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Services should disable public network access - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/63a0ac64-5d5f-4569-8a3d-df67cc1ce9d7",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - CORS should not allow every resource to access your Function Apps - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - CORS should not allow every resource to access your Function Apps - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - CORS should not allow every resource to access your Function Apps - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - CORS should not allow every resource to access your API App - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - CORS should not allow every resource to access your API App - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - CORS should not allow every resource to access your API App - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - CORS should not allow every resource to access your Web Applications - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - CORS should not allow every resource to access your Web Applications - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - CORS should not allow every resource to access your Web Applications - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        //App service Custom- Policy Assignments [ -IT | -PL | -COR ]
        {
            "displayName": "RWE - App Service Environment should be provisioned with latest versions - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "RWE - App Service Environment-provisioned with latest versions",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should be provisioned with latest versions - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "RWE - App Service Environment-provisioned with latest versions",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - App Service Environment should be provisioned with latest versions - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "RWE - App Service Environment-provisioned with latest versions",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //End App Service - Policy Assignments [ -IT | -PL | -COR ]
        //start Site Recovery Vault CMK Custom- Policy Assignments [ -IT | -PL | -COR ]
        {
            "displayName": "RWE - Site Recovery vault should use customer-managed keys to encrypt data at rest - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "rwe-encrypt-data-at-rest-using-cmk-Site-Recovery-vault",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Site Recovery vault should use customer-managed keys to encrypt data at rest - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "rwe-encrypt-data-at-rest-using-cmk-Site-Recovery-vault",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Site Recovery vault should use customer-managed keys to encrypt data at rest - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "rwe-encrypt-data-at-rest-using-cmk-Site-Recovery-vault",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //End Site Recovery Vault - Policy Assignments [ -IT | -PL | -COR ]
        //Start SQL Custom Policies for TLS1.2 & SSL enforcement- Policy Assignments [ RWE-ALZ ]

        {
            "displayName": "RWE -Azure Database for MySql server - deploys a specific min TLS version requirement",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-tls12-AzureDB-MySQL",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "RWE - SQL Managed Instance should have the minimal TLS version set to the highest version",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-tls12-SQL-Managed-Instance",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure SQL Database should have the minimal TLS version set to the highest version",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-tls12-Azure-SQL-Database",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - PostgreSQL database servers enforce SSL connection",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Modify-SSL connection-PostgreSql",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Modify"
            },
            "useIdentity": true
        },
        {
            "displayName": "RWE - RWE - MySQL database servers enforce SSL connection",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-enforce-SSL-connection-AzureDB-MySQL",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        //End  SQL Custom Policies for TLS1.2 & SSL enforcement- Policy Assignments [ RWE-ALZ ]
        //Start Key Vault - Policy Assignments [RWE-ALZ ]
        {
            "displayName": "RWE - KeyVault SoftDelete should be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Append-KV-SoftDelete",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        //End Key Vault - Policy Assignments [RWE-ALZ ] 
        
        
        // Configure network security groups(NSG) to enable traffic analytics
        {
            "displayName": "RWE Configure network security groups to enable traffic analytics",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e920df7f-9a64-4066-9b58-52684c02a091",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "nsgRegion":"westeurope",
                "storageId":"/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.Storage/storageAccounts/zc03xlzplogeuw1st001prd1",
                "workspaceResourceId":"/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourcegroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/microsoft.operationalinsights/workspaces/zc03x-lzp-log-euw1-log001-pr01",
                "workspaceRegion":"westeurope",
                "workspaceId":"4fe362c9-b365-40be-82c2-953dfbd6b70d",
                "networkWatcherRG":"networkwatcherrg",
                "networkWatcherName":"NetworkWatcher_westeurope"
            },
            "useIdentity": true   
        },
        {
            "displayName": "RWE - Auto provisioning of the Log Analytics agent should be enabled on your subscription",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/475aae12-b88a-4572-8b36-9b712b2b3a17",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Enable Azure Security Center on your subscription",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ac076320-ddcf-4066-b451-6154267e8ad2",
            "parameters": {},
            "useIdentity": true
        },
        {
            "displayName": "RWE - Activity log should be retained for at least one year",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/b02aacc0-b073-424e-8298-42b22829ee0a",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Monitor should collect activity logs from all regions",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/41388f1c-2db0-4c25-95b2-35d7f5ccbfa9",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - SSH access from the Internet should be blocked",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fab",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - SSH access from the Internet should be blocked",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fab",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - SSH access from the Internet should be blocked",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fab",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - RDP access from the Internet should be blocked -PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "Deny-RDP-From-Internet",
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - RDP access from the Internet should be blocked - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "Deny-RDP-From-Internet",
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - RDP access from the Internet should be blocked -IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "Deny-RDP-From-Internet",
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Network interfaces should not have public IPs - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Network interfaces should not have public IPs - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/83a86a26-fd1f-447c-b59d-e51f44264114",
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Network interfaces should not have public IPs - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "Audit-NET-NoPublicIPs",
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Network interfaces should disable IP forwarding - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Network interfaces should disable IP forwarding - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/88c0b9da-ce96-4b03-9635-f29a937e2900",
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Network interfaces should disable IP forwarding - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744",
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Subnets should be associated with a Network Security Group",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Gateway subnets should not be configured with a network security group - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/35f9c03a-cc27-418e-9c0c-539ff999d010",
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure VPN gateways should not use 'basic' SKU - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e345b6c3-24bd-4c93-9bbb-7e5e49a17b78",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Flow log should be configured for every network security group",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/c251913d-7d24-4958-af87-478ed3b9ba41",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
          //ISO27001 Policies
        {
            "displayName": "RWE - A maximum of 3 owners should be designated for your subscription",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },  
        {
            "displayName": "RWE - Audit Windows machines that do not have the password complexity setting enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/bf16e0bb-31e1-4646-8202-60a235cc7e74",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        }, 
        {
            "displayName": "RWE - Audit Windows machines that do not restrict the minimum password length to 14 characters",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/a2d0e922-65d0-40c4-8f87-ea6da2d307a2",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        }, 
        {
            "displayName": "RWE - Audit Windows machines that do not store passwords using reversible encryption",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/da0f98fe-a24b-4ad5-af69-bd0400233661",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        }, 
        {
            "displayName": "RWE - Auditing on SQL server should be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        }, 
        {
            "displayName": "RWE - Automation account variables should be encrypted",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Deprecated accounts should be removed from your subscription",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/6b1cbf55-e8b6-442f-ba4c-7246b6381474",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Deprecated accounts with owner permissions should be removed from your subscription",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ebb62a0c-3560-49e1-89ed-27e074e9f8ad",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Disk encryption should be applied on virtual machines",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0961003e-5a0a-4549-abde-af6a37f2724d",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Function App should only be accessible over HTTPS",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deny-FunctionApp-HTTPmode",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],           
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Service Fabric clusters should only use Azure Active Directory for client authentication",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - System updates should be installed on your machines",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/86b3d65f-7626-441e-b690-81a8b71cff60",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Vulnerabilities in security configuration on your machines should be remediated",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e1e5fd5d-3e4c-4ce1-8661-7d1873ae6b15",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Vulnerabilities on your SQL databases should be remediated",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Web Application should only be accessible over HTTPS",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deny-WebApp-HTTPmode",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        //{
        //    "displayName": "RWE - A vulnerability assessment solution should be enabled on your virtual machines",
        //    "managementGroupIdSuffix": "",
        //    "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9",
        //    "parameters": {
        //        "effect": "AuditIfNotExists"
        //    },
        //    "useIdentity": false
        //},
        {
            "displayName": "RWE - API App should only be accessible over HTTPS",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deny-APIAPP-HTTPmode",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - All network ports should be restricted on network security groups associated to your virtual machine",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - An Azure Active Directory administrator should be provisioned for SQL servers",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Audit Linux machines that allow remote connections from accounts without passwords",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ea53dbee-c6c9-4f0e-9f9e-de0039b78023",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Audit Linux machines that do not have the passwd file permissions set to 0644",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e6955644-301c-44b5-a4c4-528577de6861",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Audit Linux machines that have accounts without passwords",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f6ec09a3-78bf-4f8f-99dc-6c77182d0f99",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Audit usage of custom RBAC rules",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f8456c1c-aa66-4dfb-861a-25d127b775c9",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - External accounts with write permissions should be removed from your subscription",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/5c607a2e-c700-4744-8254-d77e7c9eb5e4",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],            
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Transparent Data Encryption on SQL databases should be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - MFA should be enabled accounts with write permissions on your subscription",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/9297c21d-2ed6-4474-b48f-163f75654ce3",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - MFA should be enabled on accounts with owner permissions on your subscription",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/aa633080-8b72-40c4-a2d7-d00c03e80bed",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - MFA should be enabled on accounts with read permissions on your subscription",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e3576e28-8b17-4677-84c3-db2990658d64",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        //{
        //    "displayName": "RWE - Monitor missing Endpoint Protection in Azure Security Center",
        //    "managementGroupIdSuffix": "",
        //    "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/af6cd1bd-1635-48cb-bde7-5b15693900b9",
        //    "parameters": {
        //        "effect": "AuditIfNotExists"
        //    },
        //    "useIdentity": false
        //}, 
        {
            "displayName": "RWE - Log Analytics agent should be installed on your virtual machine scale sets for Azure Security Center monitoring - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/a3a6ea0c-e018-4933-9ef0-5aaa1501449b",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Log Analytics agent should be installed on your virtual machine scale sets for Azure Security Center monitoring - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/a3a6ea0c-e018-4933-9ef0-5aaa1501449b",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Log Analytics agent should be installed on your virtual machine scale sets for Azure Security Center monitoring - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/a3a6ea0c-e018-4933-9ef0-5aaa1501449b",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Unattached disks should be encrypted",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2c89a2e5-7285-40fe-afe0-ae8654b92fb2",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Disabled"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Only approved VM extensions should be installed - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/c0e996f8-39cf-4af9-9f45-83fbde810432",
            "parameters": {
                "effect": "Deny",
                "approvedExtensions": [
                    "microsoft.powershell.dsc",
                    "dependencyagentlinux",
                    "dependencyagentwindows",
                    "azurediskencryptionforlinux",
                    "azurediskencryption",
                    "customscriptextension",
                    "customscriptforlinux",
                    "omsagentforlinux",
                    "microsoftmonitoringagent",
                    "IaaSDiagnostics",
                    "LinuxDiagnostic",
                    "NetworkWatcherAgentWindows",
                    "NetworkWatcherAgentLinux",
                    "VMAccessAgent",
                    "GuestHealthWindowsAgent",
                    "AzureMonitorWindowsAgent",
                    "AzureMonitorLinuxAgent",
                    "MDE.Windows",
					"MDE.Linux",
                    "vmss-devopsagents-linux",
                    "Microsoft.VisualStudio.Services.TeamServicesAgentLinux",
                    "Microsoft.Azure.DevOps.Pipelines.Agent",
                    "Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux",
                    "JsonADDomainExtension",
                    "joindomain",
                    "DSC",
                    "NvidiaGpuDriverWindows",
                    "SqlIaasExtension",
					"ConfigurationforLinux",
					"GuestAttestation",
                    "AzureBackupWindowsWorkload",
					"HybridWorkerForWindows",
					"HybridWorkerForLinux",
					"enablevmaccess",
					"CustomScript",
                    "AHBForRHEL",
                    "AHBForSLES",
                    "AADLoginForWindows"
                ]
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Only approved VM extensions should be installed - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/c0e996f8-39cf-4af9-9f45-83fbde810432",
            "parameters": {
                "effect": "Deny",
                "approvedExtensions": [
                    "microsoft.powershell.dsc",
                    "dependencyagentlinux",
                    "dependencyagentwindows",
                    "azurediskencryptionforlinux",
                    "azurediskencryption",
                    "customscriptextension",
                    "customscriptforlinux",
                    "omsagentforlinux",
                    "microsoftmonitoringagent",
                    "IaaSDiagnostics",
                    "LinuxDiagnostic",
                    "NetworkWatcherAgentWindows",
                    "NetworkWatcherAgentLinux",
                    "VMAccessAgent",
                    "GuestHealthWindowsAgent",
                    "AzureMonitorWindowsAgent",
                    "AzureMonitorLinuxAgent",
                    "MDE.Windows",
					"MDE.Linux",
                    "vmss-devopsagents-linux",
                    "Microsoft.VisualStudio.Services.TeamServicesAgentLinux",
                    "Microsoft.Azure.DevOps.Pipelines.Agent",
                    "Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux",
                    "JsonADDomainExtension",
                    "joindomain",
                    "DSC",
                    "NvidiaGpuDriverWindows",
                    "SqlIaasExtension",
					"ConfigurationforLinux",
					"GuestAttestation",
                    "AzureBackupWindowsWorkload",
					"HybridWorkerForWindows",
					"HybridWorkerForLinux",
					"enablevmaccess",
					"CustomScript",
                    "AHBForRHEL",
                    "AHBForSLES",
                    "AADLoginForWindows"
                ]
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Only approved VM extensions should be installed - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/c0e996f8-39cf-4af9-9f45-83fbde810432",
            "parameters": {
                "effect": "Deny",
                "approvedExtensions": [
                    "microsoft.powershell.dsc",
                    "dependencyagentlinux",
                    "dependencyagentwindows",
                    "azurediskencryptionforlinux",
                    "azurediskencryption",
                    "customscriptextension",
                    "customscriptforlinux",
                    "omsagentforlinux",
                    "microsoftmonitoringagent",
                    "IaaSDiagnostics",
                    "LinuxDiagnostic",
                    "NetworkWatcherAgentWindows",
                    "NetworkWatcherAgentLinux",
                    "VMAccessAgent",
                    "GuestHealthWindowsAgent",
                    "AzureMonitorWindowsAgent",
                    "AzureMonitorLinuxAgent",
                    "MDE.Windows",
					"MDE.Linux",
                    "vmss-devopsagents-linux",
                    "Microsoft.VisualStudio.Services.TeamServicesAgentLinux",
                    "Microsoft.Azure.DevOps.Pipelines.Agent",
                    "Microsoft.EnterpriseCloud.Monitoring.OmsAgentForLinux",
                    "JsonADDomainExtension",
                    "joindomain",
                    "DSC",
                    "NvidiaGpuDriverWindows",
                    "SqlIaasExtension",
					"ConfigurationforLinux",
					"GuestAttestation",
                    "AzureBackupWindowsWorkload",
					"HybridWorkerForWindows",
					"HybridWorkerForLinux",
					"enablevmaccess",
					"CustomScript",
                    "AHBForRHEL",
                    "AHBForSLES",
                    "AADLoginForWindows"
                ]
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Virtual machines should be connected to an approved virtual network",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/d416745a-506c-48b6-8ab1-83cb814bcaa3",
            "parameters": {
                "effect": "Audit",
                "virtualNetworkId___ID": "z%ORG%x-%PLATFORM%-net-%REGION%-vnet001-%ENV%"
            },
            "useIdentity": false
        },
        
        // Start - Deploy Diagnostic Activity Logs to Event Hub
        {
            "displayName": "RWE-Deploy-Diagnostics-ActivityLog-subscription-to-EventHub",
            "managementGroupIdSuffix": "",
            "policyDefinition": "RWE-Deploy-Diagnostics-ActivityLog-subscription-EventHub",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "eventHubRuleId": "/subscriptions/bb03405f-f50e-4018-8fbd-f9d9da699dc3/resourceGroups/zc03x-lzp-spk-euw1-rg-pr01/providers/Microsoft.EventHub/namespaces/zc03x-lzp-spk-eu1-evnthub-pr01/AuthorizationRules/RootManageSharedAccessKey",
                "profileName": "subscriptionToEventHub"
            },
            "useIdentity": true
        },
        {
            "displayName": "RWE-Deploy-Diagnostics-Security-Log-subscription-to-EventHub",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-securitylog-eventhub",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "eventHubDetails": "/subscriptions/bb03405f-f50e-4018-8fbd-f9d9da699dc3/resourcegroups/zc03x-lzp-spk-euw1-rg-pr01/providers/microsoft.eventhub/namespaces/zc03x-lzp-spk-eu1-evnthub-pr01/eventhubs/rwe-security/authorizationrules/security-sas",
                "resourceGroupName": "itsecinfra-defenderworkflow-euw1-rg-pr01",
                "resourceGroupLocation": "West Europe"
            },
            "useIdentity": true
        },

        // End - Deploy Diagnostic Activity Logs to Event Hub
        {
            "displayName": "Deploy network watcher when virtual networks are created",
            "managementGroupIdSuffix": "",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/a9b99dd8-06c5-4317-8629-9d86a3c6e7d9",
            "useIdentity": true
        },
        {
            "displayName": "RWE - Allowed storage account SKUs - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1",
            "parameters": {
              "listOfAllowedSKUs": [
                "Standard_LRS",
                "Standard_ZRS",
                "Premium_LRS",
                "Premium_ZRS"
              ]
            }
          },
          {
            "displayName": "RWE - Allowed storage account SKUs - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1",
            "parameters": {
              "listOfAllowedSKUs": [
                "Standard_LRS",
                "Standard_ZRS",
                "Premium_LRS",
                "Premium_ZRS"
              ]
            }
          },
          //{
          //  "displayName": "RWE -Resource logs in Azure Stream Analytics should be enabled - IT",
          //  "managementGroupIdSuffix": "-IT",
          //  "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46",
          //  "parameters": {},
          //  "useIdentity": false
          //},
          {
            "displayName": "RWE -Azure Stream Analytics jobs should use customer-managed keys to encrypt data - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "parameters": {},
            "useIdentity": false
          },

          //{
          //  "displayName": "RWE -Resource logs in Azure Stream Analytics should be enabled - COR",
          //  "managementGroupIdSuffix": "-COR",
          //  "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46",
          //  "parameters": {},
          //  "useIdentity": false
          //},
          {
            "displayName": "RWE -Azure Stream Analytics jobs should use customer-managed keys to encrypt data - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "parameters":  {},
            "useIdentity": false
          },

          //{
          //  "displayName": "RWE -Resource logs in Azure Stream Analytics should be enabled - PL",
          //  "managementGroupIdSuffix": "-PL",
          //  "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46",
          //  "parameters": {},
          //  "useIdentity": false
          //},
          {
            "displayName": "RWE -Azure Stream Analytics jobs should use customer-managed keys to encrypt data - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/87ba29ef-1ab3-4d82-b763-87fcd4f531f7",
            "parameters":  {},
            "useIdentity": false
          },
          {
            "displayName": "RWE - Allowed storage account SKUs - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/7433c107-6db4-4ad1-b57a-a76dce0154a1",
            "parameters": {
              "listOfAllowedSKUs": [
                "Standard_LRS",
                "Standard_ZRS",
                "Premium_LRS",
                "Premium_ZRS"
              ]
            }
          },
        //Storage Account - Policy Assignments [ -IT | -PL | -COR ] 
        {
            "displayName": "RWE - Storage accounts should use customer-managed key for encryption",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Storage accounts should use customer-managed key for encryption",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Storage accounts should use customer-managed key for encryption",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },          
        //HD Insights - Policy Assignments [ -IT | -PL | -COR ]
        {
            "displayName": "RWE - Azure HDInsight clusters should be injected into a virtual network",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/b0ab5b05-1c98-40f7-bb9e-dc568e41b501",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure HDInsight clusters should be injected into a virtual network",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/b0ab5b05-1c98-40f7-bb9e-dc568e41b501",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure HDInsight clusters should be injected into a virtual network",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/b0ab5b05-1c98-40f7-bb9e-dc568e41b501",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },            
        {
            "displayName": "RWE - Azure HDInsight clusters should use customer-managed keys to encrypt data at rest",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/64d314f6-6062-4780-a861-c23e8951bee5",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure HDInsight clusters should use customer-managed keys to encrypt data at rest",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/64d314f6-6062-4780-a861-c23e8951bee5",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },    
        {
            "displayName": "RWE - Azure HDInsight clusters should use customer-managed keys to encrypt data at rest",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/64d314f6-6062-4780-a861-c23e8951bee5",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },    
        {
            "displayName": "RWE - Azure HDInsight clusters should use encryption at host to encrypt data at rest",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure HDInsight clusters should use encryption at host to encrypt data at rest",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure HDInsight clusters should use encryption at host to encrypt data at rest",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1fd32ebd-e4c3-4e13-a54a-d7422d4d95f6",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Enforce TLS version for Azure HDInsight clusters to 1.2 - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "rwe-enforce-tls12-hdinsight-clusters",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Enforce TLS version for Azure HDInsight clusters to 1.2 - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "rwe-enforce-tls12-hdinsight-clusters",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Enforce TLS version for Azure HDInsight clusters to 1.2 - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "rwe-enforce-tls12-hdinsight-clusters",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },        
        //Machine Learning - Policy Assignments [ -IT | -PL | -COR ]
        {
            "displayName": "RWE - Azure Machine Learning workspaces should be encrypted with a customer-managed key",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },    
        {
            "displayName": "RWE - Azure Machine Learning workspaces should be encrypted with a customer-managed key",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },    
        {
            "displayName": "RWE - Azure Machine Learning workspaces should be encrypted with a customer-managed key",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },   
        {
            "displayName": "RWE - Machine Learning computes should have local authentication methods disabled",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },    
        {
            "displayName": "RWE - Machine Learning computes should have local authentication methods disabled",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },    
        {
            "displayName": "RWE - Machine Learning computes should have local authentication methods disabled",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Public network access should be disabled for Machine Learning - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "rwe-disable-public-network-access-machine-learning",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Public network access should be disabled for Machine Learning - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "rwe-disable-public-network-access-machine-learning",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Public network access should be disabled for Machine Learning - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "rwe-disable-public-network-access-machine-learning",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },  
        //Synapse - Policy Assignments [ -IT | -PL | -COR ]
        {
            "displayName": "RWE - Azure Synapse workspaces should use customer-managed keys to encrypt data at rest",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Synapse workspaces should use customer-managed keys to encrypt data at rest",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Synapse workspaces should use customer-managed keys to encrypt data at rest",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f7d52b2d-e161-4dfa-a82b-55e564167385",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Auditing on Synapse workspace should be enabled",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e04e5000-cd89-451d-bb21-a14d24ff9c73",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Auditing on Synapse workspace should be enabled",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e04e5000-cd89-451d-bb21-a14d24ff9c73",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Auditing on Synapse workspace should be enabled",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/e04e5000-cd89-451d-bb21-a14d24ff9c73",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        }, 
        {
            "displayName": "RWE - Vulnerability assessment should be enabled on your Synapse workspaces",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0049a6b3-a662-4f3e-8635-39cf44ace45a",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Vulnerability assessment should be enabled on your Synapse workspaces",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0049a6b3-a662-4f3e-8635-39cf44ace45a",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Vulnerability assessment should be enabled on your Synapse workspaces",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0049a6b3-a662-4f3e-8635-39cf44ace45a",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },           
        {
            "displayName": "RWE - Synapse workspace auditing settings should have action groups configured to capture critical activities",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2b18f286-371e-4b80-9887-04759970c0d3",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Synapse workspace auditing settings should have action groups configured to capture critical activities",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2b18f286-371e-4b80-9887-04759970c0d3",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Synapse workspace auditing settings should have action groups configured to capture critical activities",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2b18f286-371e-4b80-9887-04759970c0d3",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Synapse workspaces should disable public network access - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/38d8df46-cf4e-4073-8e03-48c24b29de0d",
            "parameters": {
                "effect": "Deny"
            },
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "useIdentity": false
        },
        {
            "displayName": "RWE - IP firewall rules on Azure Synapse workspaces should be removed",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/56fd377d-098c-4f02-8406-81eb055902b8",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - IP firewall rules on Azure Synapse workspaces should be removed",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/56fd377d-098c-4f02-8406-81eb055902b8",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - IP firewall rules on Azure Synapse workspaces should be removed",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/56fd377d-098c-4f02-8406-81eb055902b8",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //Purview - Policy Assignments [ -IT | -PL | -COR ]
        {
            "displayName": "RWE - Azure Purview should disable public network access",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "rwe-disable-public-network-access-purview",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Purview should disable public network access",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "rwe-disable-public-network-access-purview",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Purview should disable public network access",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "rwe-disable-public-network-access-purview",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        //DataFactory - Policy Assignments [ -IT | -PL | -COR ]
        {
            "displayName": "RWE - Azure data factories should be encrypted with a customer-managed key - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/4ec52d6d-beb7-40c4-9a9e-fe753254690e",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure data factories should be encrypted with a customer-managed key - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/4ec52d6d-beb7-40c4-9a9e-fe753254690e",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure data factories should be encrypted with a customer-managed key - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/4ec52d6d-beb7-40c4-9a9e-fe753254690e",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //{
        //    "displayName": "RWE - Azure Data Factory should use private link - IT",
        //    "managementGroupIdSuffix": "-IT",
        //    "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/8b0323be-cc25-4b61-935d-002c3798c6ea",
        //    "parameters": {
        //        "effect": "AuditIfNotExists"
        //    },
        //    "useIdentity": false
        //},
        //{
        //    "displayName": "RWE - Azure Data Factory should use private link - PL",
        //    "managementGroupIdSuffix": "-PL",
        //    "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/8b0323be-cc25-4b61-935d-002c3798c6ea",
        //    "parameters": {
        //        "effect": "AuditIfNotExists"
        //    },
        //    "useIdentity": false
        //},
        //{
        //    "displayName": "RWE - Azure Data Factory should use private link - COR",
        //    "managementGroupIdSuffix": "-COR",
        //    "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/8b0323be-cc25-4b61-935d-002c3798c6ea",
        //    "parameters": {
        //        "effect": "AuditIfNotExists"
        //    },
        //    "useIdentity": false
        //},
        //{
        //    "displayName": "RWE - Azure Data Factory should use private link - SP",
        //    "managementGroupIdSuffix": "-SP",
        //    "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/8b0323be-cc25-4b61-935d-002c3798c6ea",
        //    "parameters": {
        //        "effect": "AuditIfNotExists"
        //    },
        //    "useIdentity": false
        //},
		
        //Databricks - Policy Assignments [ -IT | -PL | -COR ]
        {
            "displayName": "RWE - Azure Databricks should disable public network access - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "rwe-disable-public-network-access-databricks",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Databricks should disable public network access - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "rwe-disable-public-network-access-databricks",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Databricks should disable public network access - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "rwe-disable-public-network-access-databricks",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Databricks File System should encrypt data at rest using customer managed keys - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "rwe-encrypt-data-at-rest-using-cmk-databricks-filesystem",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Databricks File System should encrypt data at rest using customer managed keys - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "rwe-encrypt-data-at-rest-using-cmk-databricks-filesystem",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Databricks File System should encrypt data at rest using customer managed keys - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "rwe-encrypt-data-at-rest-using-cmk-databricks-filesystem",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Databricks workspace should encrypt data at rest using customer managed keys - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "rwe-encrypt-data-at-rest-using-cmk-databricks-workspace",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Databricks workspace should encrypt data at rest using customer managed keys - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "rwe-encrypt-data-at-rest-using-cmk-databricks-workspace",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Azure Databricks workspace should encrypt data at rest using customer managed keys - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "rwe-encrypt-data-at-rest-using-cmk-databricks-workspace",
            "parameters": {
                "effect": "audit"
            },
            "useIdentity": false
        },
        //Monitor central LAWS configuration for VMs [ -IT | -PL | -COR ]
        {
            "displayName": "Virtual machines should be connected to the Central-LogAnalyticsWorkspace - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917",
            "parameters": {
                "effect": "AuditIfNotExists",
                "logAnalyticsWorkspaceId":"4fe362c9-b365-40be-82c2-953dfbd6b70d"
            },
            "useIdentity": false
        },
        {
            "displayName": "Virtual machines should be connected to the Central-LogAnalyticsWorkspace - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917",
            "parameters": {
                "effect": "AuditIfNotExists",
                "logAnalyticsWorkspaceId":"4fe362c9-b365-40be-82c2-953dfbd6b70d"
            },
            "useIdentity": false
        },
        {
            "displayName": "Virtual machines should be connected to the Central-LogAnalyticsWorkspace - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917",
            "parameters": {
                "effect": "AuditIfNotExists",
                "logAnalyticsWorkspaceId":"4fe362c9-b365-40be-82c2-953dfbd6b70d"
            },
            "useIdentity": false
        },
        //Audit Windows/Linux virtual machines if the Log Analytics extension is not installed [ -IT | -PL | -COR ]
        {
            "displayName": "Virtual Machines should have the Log Analytics extension installed  - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/a70ca396-0a34-413a-88e1-b956c1e683be",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "Virtual Machines should have the Log Analytics extension installed  - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/a70ca396-0a34-413a-88e1-b956c1e683be",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        {
            "displayName": "Virtual Machines should have the Log Analytics extension installed  - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/a70ca396-0a34-413a-88e1-b956c1e683be",
            "parameters": {
                "effect": "AuditIfNotExists"
            },
            "useIdentity": false
        },
        //Audit Central LAWS configuration for VMs [ IT, PL and COR ]
        {
            "displayName": "Audit Central-LogAnalyticsWorkspace configuration for Virtual machines",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f47b5582-33ec-4c5c-87c0-b010a6b2e917",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-OT"
            ],           
            "parameters": {
                "effect": "AuditIfNotExists",
                "logAnalyticsWorkspaceId":"4fe362c9-b365-40be-82c2-953dfbd6b70d"
            },
            "useIdentity": false
        },
        //Monitor custom RBAC owner roles[ -IT | -PL | -COR ]
        {
            "displayName": "RWE - custom subscription owner roles should not exist - COR",
            "managementGroupIdSuffix": "-COR",
            "policyDefinition": "rwe-check-custom-subscription-owner-roles",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - custom subscription owner roles should not exist - PL",
            "managementGroupIdSuffix": "-PL",
            "policyDefinition": "rwe-check-custom-subscription-owner-roles",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - custom subscription owner roles should not exist - IT",
            "managementGroupIdSuffix": "-IT",
            "policyDefinition": "rwe-check-custom-subscription-owner-roles",
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        //AzureDefender Policies
        {
            "displayName": "Configure Azure Defender for Kubernetes to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/133047bf-1369-41e3-a3be-74a11ed1395a",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for Containers to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/c9ddb292-b203-4738-aead-18e2716e858f",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for Key Vaults to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/1f725891-01c0-420a-9059-4fa46cb770b7",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for DNS to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2370a3c1-4a25-4283-a91a-c9c1a145fb2f",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for SQL servers on machines to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/50ea7265-7d8c-429e-9a7d-ca1f410191c3",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for Storage to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/cfdc5972-75b3-4418-8ae1-7f5c36839390",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for App Service to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/b40e7bcd-a1e5-47fe-b9cf-2f534d0bfb7d",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for servers to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-defender-for-servers",
            "parameters": {
               "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for Resource Manager to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/b7021b2b-08fd-4dc0-9de7-3c6ece09faf9",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for Azure SQL database to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/b99b73e7-074b-4089-9395-b7236f094491",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for container registries to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/d3d1e68e-49d4-4b56-acff-93cef644b432",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for open-source relational databases to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/44433aa3-7ec2-4002-93ea-65c65ff0310a",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        {
            "displayName": "Configure Azure Defender for Cosmos DB to be enabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/82bf5b87-728b-4a74-ba4d-6123845cf542",
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        
        //Enterprise Scale Architecture policies [ RWE-ALZ ]
        {
            "displayName": "RWE - SQL managed instances - Deploy a specific min tls version requirement",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-tls12-Azure-managedInstances",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        
        {
            "displayName": "RWE - SQL server - deploys a specific min TLS version requirement",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-tls12-AzureDB-SQLServer",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        
        {
            "displayName": "RWE - SQL server - Deploy SQL Database Security Alerts",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-security-alert-SQLServer",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "emailAddresses": "azure_security_alerts@rwe.com"
            },
            "useIdentity": true
        },    
        {
            "displayName": "RWE - SQL server - Deploy SQL Database vulnerability assessments",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-vulnerability-SQLServer",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "vulnerabilityAssessmentsEmail": "azure_security_alerts@rwe.com"
            },
            "useIdentity": true
        },
        
        //Azure Recovery Services vaults should use private link for backup [ RWE-ALZ ]
        {
            "displayName": "RWE - Azure Recovery Services vaults should use private link for backup",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/deeddb44-9f94-4903-9fa0-081d524406e3",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        // Azure Data Explorer Encryption
        {
            "displayName": "RWE - Disk encryption should be enabled on Azure Data Explorer - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/f4b53539-8df9-40e4-86c6-6b607703bd4e",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        // Azure Data Explorer Public Access - Modify Custom
                {
            "displayName": "RWE - Public Access should be disabled on Azure Data Explorer - Modify",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-disable-public-network-access-dataexplorer",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Modify"
            },
            "useIdentity": true
        },
        // Azure Defender for Cloud Workflow Automation Onboarding - compliance
        {
            "displayName": "RWE - Deploy Workflow Automation for Microsoft Defender for Cloud Compliance",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-workflow-automation-compliance",
            "parameters": {
                "automationName": "Defender-for-Cloud-Compliance",
                "resourceGroupName": "itsecinfra-defenderworkflow-euw1-rg-pr01",
                "regulatoryComplianceStandards": ["Azure-CIS-1.3.0", "Azure-Security-Benchmark"],
                "resourceGroupLocation": "West Europe",
                "logicAppResourceId": "/subscriptions/8469272a-ff88-467b-9467-47edcbe4f36f/resourceGroups/zc03x-itsecinfra-defenderworkflow-euw1-rg-pr01/providers/Microsoft.Logic/workflows/zc03xdefwfloweuw1la001pr01",
                "logicAppTrigger": "When an Azure Security Center regulatory compliance assessment is created"
            },
            "useIdentity": true
        },
        // Deploy Log Analytics Workspace Agent to VMSS - Windows
        {
            "displayName": "RWE - Deploy - Configure Log Analytics extension to be enabled on Windows virtual machine scale sets",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/3c1b3629-c8f8-4bf6-862c-037cb9094038",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "logAnalytics": "/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourcegroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/microsoft.operationalinsights/workspaces/zc03x-lzp-log-euw1-log001-pr01",
                "listOfImageIdToInclude": [
                "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016",
                "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016_V2",
                "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019",
                "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019_V2",
                "/subscriptions/0c753207-134f-4389-a8a7-50137d64ae6e/resourceGroups/zc03x-citrixcloud-test-003/providers/Microsoft.Compute/galleries/VMDST0001_tfiyq/images/VMDST0001_t6c0u"
                    ],
                "effect": "DeployIfNotExists"
            },
            "useIdentity": true
        },
        // Deploy Log Analytics Workspace Agent to VMSS - Linux
        {
            "displayName": "RWE - Deploy - Configure Log Analytics extension to be enabled on Linux virtual machine scale sets",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/5ee9e9ed-0b42-41b7-8c9c-3cfb2fbe2069",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "logAnalytics": "/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourcegroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/microsoft.operationalinsights/workspaces/zc03x-lzp-log-euw1-log001-pr01",
                "listOfImageIdToInclude": [
                "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximglineuw1sig001pr01/images/cif-rhel8_x86_64-gen2",
                "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_pr/images/cif-rhel8_x86_64-gen2",
                "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-cib-linux-euw1-rg-pr/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_sp/images/testing_cif-rhel8_x86_64-gen2"
                    ]
            },
            "useIdentity": true
        },
        // Deny Azure Container Instances without private endpoint
        {
            "displayName": "RWE - Azure Container Instance container group should deploy into a virtual network",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/8af8f826-edcb-4178-b35f-851ea6fea615",
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        // Azure Storage Account - Disable public blob access
        {
            "displayName": "RWE - Configure your Storage account public access to be disallowed - Modify",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/13502221-8df0-4414-9937-de9c5c4e396b",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Modify"
          },
            "useIdentity": true
        },
        // Cognitive Services - Disable public access
        {
            "displayName": "RWE - Cognitive Services should not allow unrestricted network access - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-cognitive-services-unrestricted-network-access",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "deny"
          },
            "useIdentity": false
        },
        // Cognitive Search - Disable public access
        {
            "displayName": "RWE - Azure Cognitive Search services should disable public network access - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ee980b6d-0eca-4501-8d54-f6290fd512c3",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
          },
            "useIdentity": false
        },
        // Storage Account - Deny Public Blob
        {
            "displayName": "RWE - Storage account public access should be disallowed - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "deny"
          },
            "useIdentity": false
        },
        //Added the block to deploy US-hub vnet link to EU private dns zones
        {
            "displayName": "RWE - Deploy US-Hub VnetLink to EU-Hub PrivateDNSZones",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deploy-USHubVnetLink-EUHubPrivateDNSZones",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {         
                "virtualNetworkLinkName": "linktovnet-ussc",
                "targetVnet": "/subscriptions/b1b313d1-fdfc-4ece-a87d-f368f7af6944/resourceGroups/zc03x-lzp-net-ussc1-rg-pr01/providers/Microsoft.Network/virtualNetworks/zc03x-lzp-net-ussc1-vnet001-pr01"
            },
            "useIdentity": true
        },
        // Data Bricks Guard railing
        {
            "displayName": "RWE - Azure Databricks Workspaces should disable public network access - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0e7849de-b939-4c50-ab48-fc6b0f5eeba2",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
          },
            "useIdentity": false
        },
        // Service Bus Guard railing
        {
            "displayName": "RWE - ServiceBus minimum TLS version 1.2 enforcement - Append",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Append-ServiceBus-sslEnforcement",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Service Bus Namespaces should disable public network access - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-service-bus-unrestricted-network-access",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "deny"
          },
            "useIdentity": false
        },

       // Event Hub Guard railing
        {
            "displayName": "RWE - Event Hub minimum TLS version 1.2 enforcement - Append",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Append-EventHub-sslEnforcement",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": false
        },
        {
            "displayName": "RWE - Event Hub Namespaces should disable public network access - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-event-hub-unrestricted-network-access",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "audit"
          },
            "useIdentity": false
        },
        // Container Apps Guard railing
        {
            "displayName": "RWE - Container Apps should only be accessible over HTTPS - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0e80e269-43a4-4ae9-b5bc-178126b8a5cb",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
          },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Authentication should be enabled on Container Apps - Audit",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/2b585559-a78e-4cc4-b1aa-fb169d2f6b96",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "AuditIfNotExists"
          },
            "useIdentity": false
        },
        {
            "displayName": "RWE - Container Apps environment should disable public network access - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/d074ddf8-01a5-4b5e-a2b8-964aed452c0a",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
          },
            "useIdentity": false
        },
        // Deploy WAF Logging to Event Hub (Splunk)
        {
            "displayName": "RWE - Deploy WAF Logging to Event Hub",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deploy-WAF-Logs-EventHub",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "eventHubRuleId": "/subscriptions/bb03405f-f50e-4018-8fbd-f9d9da699dc3/resourceGroups/zc03x-lzp-spk-euw1-rg-pr01/providers/Microsoft.EventHub/namespaces/zc03x-lzp-spk-eu1-evnthub-pr01/AuthorizationRules/RootManageSharedAccessKey"
            },
            "useIdentity": true
        },
        // Deploy Bastion Logging to Event Hub (Splunk)
        {
            "displayName": "RWE - Deploy Bastion Logging to Event Hub",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Deploy-Bastion-Logs-EventHub",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "eventHubRuleId": "/subscriptions/bb03405f-f50e-4018-8fbd-f9d9da699dc3/resourceGroups/zc03x-lzp-spk-euw1-rg-pr01/providers/Microsoft.EventHub/namespaces/zc03x-lzp-spk-eu1-evnthub-pr01/AuthorizationRules/RootManageSharedAccessKey"
            },
            "useIdentity": true
        },
        //Deploy UAMI for VMs (Custom)
        {
            "displayName": "RWE Configure Virtual machines to use user-assigned managed identity",
            "managementGroupIdSuffix": "",
            "policyDefinition": "RWE-Deploy-UserAssignedManagedIdentity-VMs",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": true
        },
        //Deploy AMA for Windows VMs (Custom)
        {
            "displayName": "RWE Configure Windows virtual machines to run Azure Monitor Agent using user assigned managed identity based authentication",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-install-ama-windows-vms",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "listOfWindowsImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019_V2",
                    "/subscriptions/0c753207-134f-4389-a8a7-50137d64ae6e/resourceGroups/zc03x-citrixcloud-test-003/providers/Microsoft.Compute/galleries/VMDST0001_tfiyq/images/VMDST0001_t6c0u",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2019_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2016"                    
                ]
            },
            "useIdentity": true
        },
        //Deploy AMA for Linux VMs (Custom)
        {
            "displayName": "RWE Configure Linux virtual machines to run Azure Monitor Agent using user assigned managed identity based authentication",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-install-ama-linux-vms",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "listOfLinuxImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximglineuw1sig001pr01/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_pr/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-cib-linux-euw1-rg-pr/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_sp/images/testing_cif-rhel8_x86_64-gen2"
                ]
            },
            "useIdentity": true
        },         
        //Deploy DCR for Windows VMs
        {
            "displayName": "RWE Configure Windows Machines Eventlogs to be associated with a Data Collection Rule",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-associate-dcr-wineventlogs-vms",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "listOfWindowsImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019_V2",
                    "/subscriptions/0c753207-134f-4389-a8a7-50137d64ae6e/resourceGroups/zc03x-citrixcloud-test-003/providers/Microsoft.Compute/galleries/VMDST0001_tfiyq/images/VMDST0001_t6c0u",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2019_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2016",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2016_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2019"
                ],
                "dcrResourceId":"/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.Insights/dataCollectionRules/zc03x-lzp-wineventlogs-euw1-dcr-pr01"
            },
            "useIdentity": true,
            "uami": "/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.ManagedIdentity/userAssignedIdentities/zxc03-lzp-uami-dcr-euw1-pr01"
        },
        //Deploy DCR for Linux VMs
        {
            "displayName": "RWE Configure Linux Machines Syslogs to be associated with a Data Collection Rule",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-associate-dcr-linsyslogs-vms",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "listOfLinuxImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximglineuw1sig001pr01/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_pr/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-cib-linux-euw1-rg-pr/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_sp/images/testing_cif-rhel8_x86_64-gen2"
                ],
                "dcrResourceId":"/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.Insights/dataCollectionRules/zc03x-lzp-linuxsyslogs-euw1-dcr-pr01"
            },
            "useIdentity": true,
            "uami": "/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.ManagedIdentity/userAssignedIdentities/zxc03-lzp-uami-dcr-euw1-pr01"   
        },
        //Deploy AzureMonitor-DCR for Windows VMs
        {
            "displayName": "RWE Configure Windows Virtual Machines to be associated with a Data Collection Rule for Azure Monitor",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-associate-dcr-windows-vms",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "listOfWindowsImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019_V2",
                    "/subscriptions/0c753207-134f-4389-a8a7-50137d64ae6e/resourceGroups/zc03x-citrixcloud-test-003/providers/Microsoft.Compute/galleries/VMDST0001_tfiyq/images/VMDST0001_t6c0u",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2019_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2016",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2016_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2019"
                ],
                "dcrResourceId":"/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.Insights/dataCollectionRules/zc03x-lzp-perfcounters-euw1-dcr-pr01"
            },
            "useIdentity": true,
            "uami": "/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.ManagedIdentity/userAssignedIdentities/zxc03-lzp-uami-dcr-euw1-pr01"
        },
        //Deploy AzureMonitor-DCR for Linux VMs
        {
            "displayName": "RWE Configure Linux Virtual Machines to be associated with a Data Collection Rule for Azure Monitor",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-associate-dcr-linux-vms",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "listOfLinuxImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximglineuw1sig001pr01/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_pr/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-cib-linux-euw1-rg-pr/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_sp/images/testing_cif-rhel8_x86_64-gen2"
                ],
                "dcrResourceId":"/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.Insights/dataCollectionRules/zc03x-lzp-perfcounters-euw1-dcr-pr01"
            },
            "useIdentity": true,
            "uami": "/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.ManagedIdentity/userAssignedIdentities/zxc03-lzp-uami-dcr-euw1-pr01"
        },
        //Deploy DCE for Windows VMs
        {
            "displayName": "RWE Configure DCE to be associated with Windows VMs",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Association-DCE-Windows-VM",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "listOfWindowsImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019_V2",
                    "/subscriptions/0c753207-134f-4389-a8a7-50137d64ae6e/resourceGroups/zc03x-citrixcloud-test-003/providers/Microsoft.Compute/galleries/VMDST0001_tfiyq/images/VMDST0001_t6c0u",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2019_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2016",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2016_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2019"
                ],
                "dcrResourceId":"/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.Insights/dataCollectionEndpoints/zxc03-lzp-dce-euw1-pr01",
                "resourceType":"Microsoft.Insights/dataCollectionEndpoints"
            },
            "useIdentity": true,
            "uami": "/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.ManagedIdentity/userAssignedIdentities/zxc03-lzp-uami-dcr-euw1-pr01"
        },
        //Deploy DCE for Linux VMs
        {
            "displayName": "RWE Configure DCE to be associated with Linux VMs",
            "managementGroupIdSuffix": "",
            "policyDefinition": "Association-DCE-Linux-VM",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "listOfLinuxImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximglineuw1sig001pr01/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_pr/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-cib-linux-euw1-rg-pr/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_sp/images/testing_cif-rhel8_x86_64-gen2"
                ],
                "dcrResourceId":"/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.Insights/dataCollectionEndpoints/zxc03-lzp-dce-euw1-pr01",
                "resourceType":"Microsoft.Insights/dataCollectionEndpoints"
            },
            "useIdentity": true,
            "uami": "/subscriptions/5e3bb54e-f41f-45c8-9137-b17927da887f/resourceGroups/zc03x-centrallogging-azw-euw1-rg-pr01/providers/Microsoft.ManagedIdentity/userAssignedIdentities/zxc03-lzp-uami-dcr-euw1-pr01"
        },
        //Deploy Dependency Agent for Windows VMs
        {
            "displayName": "RWE Deploy Dependency agent to be enabled on Windows virtual machines with Azure Monitoring Agent settings",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-dependency-agent-with-amasettings-windows",            
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "listOfWindowsImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2016_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximgwinsigeuw1sig001pr01/images/Windows-2019_V2",
                    "/subscriptions/0c753207-134f-4389-a8a7-50137d64ae6e/resourceGroups/zc03x-citrixcloud-test-003/providers/Microsoft.Compute/galleries/VMDST0001_tfiyq/images/VMDST0001_t6c0u",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2019_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2016",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2016_V2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/images/Image-Windows2019"
                ]
            },
            "useIdentity": true
        },
        //Deploy Dependency Agent for Linux VMs
        {
            "displayName": "RWE Deploy Dependency agent for Linux virtual machines with Azure Monitoring Agent settings",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rwe-deploy-dependency-agent-with-amasettings-linux",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "listOfLinuxImageIdToInclude": [
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03ximglineuw1sig001pr01/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-win-lin-img-sig-euw1-rg-pr01/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_pr/images/cif-rhel8_x86_64-gen2",
                    "/subscriptions/43e0d68e-3d86-4ca8-9a3a-83ff26cbec8d/resourceGroups/zc03x-cib-linux-euw1-rg-pr/providers/Microsoft.Compute/galleries/zc03x_cib_linux_euw1_gal_sp/images/testing_cif-rhel8_x86_64-gen2"
                ]
            },
            "useIdentity": true
        },
        // Audit RG, Vnet, Subnet Naming standards
        {
            "displayName": "RWE Audit RG Naming standards",
            "managementGroupIdSuffix": "",
            "policyDefinition": "rg-naming-standards",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": true
        },
        {
            "displayName": "RWE Audit Vnet Naming standards",
            "managementGroupIdSuffix": "",
            "policyDefinition": "vnet-naming-standards",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": true
        },
        {
            "displayName": "RWE Audit Subnet Naming standards",
            "managementGroupIdSuffix": "",
            "policyDefinition": "subnet-naming-standards",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {},
            "useIdentity": true
        },        
        // Azure Arc Policies
        {
            "displayName": "RWE - Azure Arc Private Link Scopes should disable public network access - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/898f2439-3333-4713-af25-f1d78bc50556",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false 
        },
        // API Management Policies
        {
            "displayName": "RWE - Configure API Management services to disable access to API Management public service configuration endpoints",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/7ca8c8ac-3a6e-493d-99ba-c5fa35347ff2",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "DeployIfNotExists",
                "endpointType": "Management"
            },
            "useIdentity": true
        },
        {
            "displayName": "RWE - API Management services should use a virtual network - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - API Management APIs should use only encrypted protocols - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ee7495e7-3ba7-40b6-bfee-c29e22cc75d4",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - API Management should have username and password authentication disabled",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ffe25541-3853-4f4e-b71d-064422294b11",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Audit"
            },
            "useIdentity": false
        },
        {
            "displayName": "RWE - API Management calls to API backends should be authenticated - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/c15dcc82-b93c-4dcb-9332-fbf121685b54",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        // Front Door TLS 
        {
            "displayName": "RWE - Azure Front Door Standard and Premium should be running minimum TLS version of 1.2 - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/679da822-78a7-4eff-8fff-a899454a9970",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        // WAF Mode for Front Door
        {
            "displayName": "RWE - Web Application Firewall (WAF) should use the specified mode for Azure Front Door Service",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/425bea59-a659-4cbb-8d31-34499bd030b8",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Audit",
                "modeRequirement": "Prevention"
            },
            "useIdentity": false
        },       
        // CosmosDB Firewall policy
        {
            "displayName": "RWE - Azure Cosmos DB accounts should have firewall rules - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        },
        // Azure File Sync Policies
        {
            "displayName": "RWE - Modify - Configure Azure File Sync to disable public network access",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/0e07b2e9-6cd9-4c40-9ccb-52817b95133b",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Modify"
            },
            "useIdentity": true
        },
        // Azure NetApp files
        {
            "displayName": "RWE - Azure NetApp Files SMB Volumes should use SMB3 encryption - Deny",
            "managementGroupIdSuffix": "",
            "policyDefinition": "/providers/Microsoft.Authorization/policyDefinitions/ddcf4b94-9dfa-4a80-aca6-22bb654fde72",
            "notScopes": [
                "/providers/Microsoft.Management/managementGroups/RWE-ALZ-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-TEST-SP",
                "/providers/Microsoft.Management/managementGroups/RWE-ALZP-ROOT-DEV-SP"
            ],
            "parameters": {
                "effect": "Deny"
            },
            "useIdentity": false
        }

    ]
